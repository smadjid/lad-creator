{"ast":null,"code":"import _toConsumableArray from\"C:/Users/Madjid Sadallah/Documents/GitHub/CoGenDash/lad-creator/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _objectSpread from\"C:/Users/Madjid Sadallah/Documents/GitHub/CoGenDash/lad-creator/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _slicedToArray from\"C:/Users/Madjid Sadallah/Documents/GitHub/CoGenDash/lad-creator/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import\"./library-view.css\";import React,{useState,useEffect}from\"react\";import Actions from\"./panels_lib/panel_actions\";import axios from\"axios\";import{AddBoxRounded,EditRounded,HighlightOffRounded}from\"@material-ui/icons\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export var PanelContext=/*#__PURE__*/React.createContext();function Panels(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),panels=_useState2[0],setPanels=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),visualizations=_useState4[0],setVisualizations=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),indicators=_useState6[0],setIndicators=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),showModal=_useState8[0],setShowModal=_useState8[1];var _useState9=useState(),_useState10=_slicedToArray(_useState9,2),currentPanel=_useState10[0],setCurrentPanel=_useState10[1];var _useState11=useState(),_useState12=_slicedToArray(_useState11,2),currentIndicator=_useState12[0],setCurrentIndicator=_useState12[1];var _useState13=useState(),_useState14=_slicedToArray(_useState13,2),currentVisualization=_useState14[0],setCurrentVisualization=_useState14[1];var panelContext=[currentPanel,setCurrentPanel,currentIndicator,setCurrentIndicator,currentVisualization,setCurrentVisualization,indicators,visualizations];var _useState15=useState(true),_useState16=_slicedToArray(_useState15,2),creationMode=_useState16[0],setCreationMode=_useState16[1];var handleModalClose=function handleModalClose(){setShowModal(false);};var handleModalSave=function handleModalSave(){setCurrentPanel(_objectSpread(_objectSpread({},currentPanel),{},{visualization_id:currentVisualization.id}));var element=currentPanel;element.visualization_id=currentVisualization.id;element.indicator_id=currentIndicator.id;console.log(element);if(creationMode)axios.post(\"http://localhost:3001/panels\",element).then(function(){setPanels([].concat(_toConsumableArray(panels),[{data:element,headers:{\"Content-Type\":\"multipart/form-data\"}}]));updateDisplay();});else axios.put(\"http://localhost:3001/panels\",element).then(function(res){setPanels(panels.map(function(item){return item.id===element.id?{id:item.id,title:item.title,description:item.description,visualization_id:item.visualization_id,indicator_id:item.indicator_id}:item;}));updateDisplay();});setShowModal(false);updateDisplay();};var deletePanel=function deletePanel(id){window.confirm(\"Are you sure you want to delete this type of panel?\")?axios.delete(\"http://localhost:3001/panels/\".concat(id)).then(function(res){setPanels(panels.filter(function(item){return item.id!==id;}));}):id=id;updateDisplay();};var getPanels=function getPanels(){axios.get(\"http://localhost:3001/panels\").then(function(res){setPanels(res.data);});};var getVisualizations=function getVisualizations(){axios.get(\"http://localhost:3001/visualizations\").then(function(res){setVisualizations(res.data);});};var getIndicators=function getIndicators(){axios.get(\"http://localhost:3001/indicators\").then(function(res){setIndicators(res.data);});};useEffect(function(){getPanels();getVisualizations();getIndicators();},[]);var updateDisplay=function updateDisplay(){getPanels();getVisualizations();getIndicators();};var decodeChart=function decodeChart(blob){if(!blob)return;if(typeof blob===\"string\")return blob;var data=blob.data;var img=new Buffer.from(data).toString(\"ascii\");return img;};var fetchVizElement=function fetchVizElement(id){if(typeof id==='undefined')return{title:null,chart:null};else{var elt=visualizations.find(function(x){return x.id===id;});if(elt)return elt;else return{title:null,chart:null};}};var fetchIndElement=function fetchIndElement(id){if(typeof id==='undefined')return;else{var elt=indicators.find(function(x){return x.id===id;});if(elt)return elt.title;}};var CreateNewPanel=function CreateNewPanel(){var item={title:\"New\",description:\"Description\",visualization_id:null,indicator_id:null};setCurrentIndicator(indicators[0]);setCurrentVisualization(visualizations[0]);setCurrentPanel(item);setCreationMode(true);setShowModal(true);return;};var EditPanel=function EditPanel(item){indicators.map(function(elt){if(elt.id==item.indicator_id)setCurrentIndicator(elt);});visualizations.map(function(elt){if(elt.id==item.visualization_id)setCurrentVisualization(elt);});setCurrentPanel(item);setCreationMode(false);setShowModal(true);};return/*#__PURE__*/_jsxs(PanelContext.Provider,{value:panelContext,children:[/*#__PURE__*/_jsx(Actions,{title:\"un titre\",show:showModal,mode:\"Creation\",panels:panels,setPanels:setPanels,updateDisplay:updateDisplay,onClose:handleModalClose,onSave:handleModalSave}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"button\",{className:\"btn btn-success\",onClick:CreateNewPanel,children:[/*#__PURE__*/_jsx(AddBoxRounded,{}),\" \\xA0 New panel type\"]})}),/*#__PURE__*/_jsxs(\"table\",{className:\"table table-bordered table-hover table-dark table-striped text-md-start\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"#\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Title\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Indicator\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Representation\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Description\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Actions\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:panels.map(function(item){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{scope:\"row\",children:item.id}),/*#__PURE__*/_jsx(\"td\",{children:item.title}),/*#__PURE__*/_jsx(\"td\",{children:fetchIndElement(item.indicator_id)}),/*#__PURE__*/_jsxs(\"td\",{children:[\" \",/*#__PURE__*/_jsx(\"i\",{children:fetchVizElement(item.visualization_id).title}),/*#__PURE__*/_jsx(\"div\",{className:\"chart_box\",children:/*#__PURE__*/_jsx(\"img\",{alt:\"Chart\",src:decodeChart(fetchVizElement(item.visualization_id).chart)})})]}),/*#__PURE__*/_jsx(\"td\",{children:item.description}),/*#__PURE__*/_jsxs(\"td\",{children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-sm btn-outline-primary\",onClick:function onClick(){return EditPanel(item);},children:/*#__PURE__*/_jsx(EditRounded,{})}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-sm btn-outline-danger\",onClick:function onClick(){return deletePanel(item.id);},children:/*#__PURE__*/_jsx(HighlightOffRounded,{})})]})]},item.id);})})]})]});}export default Panels;","map":{"version":3,"sources":["C:/Users/Madjid Sadallah/Documents/GitHub/CoGenDash/lad-creator/src/components/library/panels.js"],"names":["React","useState","useEffect","Actions","axios","AddBoxRounded","EditRounded","HighlightOffRounded","PanelContext","createContext","Panels","panels","setPanels","visualizations","setVisualizations","indicators","setIndicators","showModal","setShowModal","currentPanel","setCurrentPanel","currentIndicator","setCurrentIndicator","currentVisualization","setCurrentVisualization","panelContext","creationMode","setCreationMode","handleModalClose","handleModalSave","visualization_id","id","element","indicator_id","console","log","post","then","data","headers","updateDisplay","put","res","map","item","title","description","deletePanel","window","confirm","delete","filter","getPanels","get","getVisualizations","getIndicators","decodeChart","blob","img","Buffer","from","toString","fetchVizElement","chart","elt","find","x","fetchIndElement","CreateNewPanel","EditPanel"],"mappings":"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","sourcesContent":["import \"./library-view.css\";\r\n\r\nimport React, { useState, useEffect } from \"react\";\r\nimport Actions from \"./panels_lib/panel_actions\";\r\nimport axios from \"axios\";\r\nimport {\r\n  AddBoxRounded,\r\n  EditRounded,\r\n  HighlightOffRounded,\r\n} from \"@material-ui/icons\";\r\n\r\nexport const PanelContext = React.createContext();\r\n\r\nfunction Panels() {\r\n  const [panels, setPanels] = useState([]);\r\n  const [visualizations, setVisualizations] = useState([]);\r\n  const [indicators, setIndicators] = useState([]);\r\n\r\n  const [showModal, setShowModal] = useState(false);\r\n\r\n  \r\n  const [currentPanel, setCurrentPanel] = useState();\r\n  const [currentIndicator, setCurrentIndicator] = useState();\r\n  const [currentVisualization, setCurrentVisualization] = useState();\r\n  \r\n  const panelContext = [\r\n    currentPanel,\r\n    setCurrentPanel,\r\n    currentIndicator,\r\n    setCurrentIndicator,\r\n    currentVisualization,\r\n    setCurrentVisualization,\r\n    indicators,\r\n    visualizations\r\n  ];\r\n\r\n  const [creationMode, setCreationMode] = useState(true);\r\n\r\n  const handleModalClose = () => {\r\n    setShowModal(false);\r\n  };\r\n\r\n  const handleModalSave = () => {\r\n\r\n    setCurrentPanel({...currentPanel,visualization_id:currentVisualization.id});\r\n\r\n    let element = currentPanel;\r\n    element.visualization_id=currentVisualization.id;\r\n    element.indicator_id=currentIndicator.id;\r\n    console.log(element);\r\n     \r\n    if (creationMode)\r\n      axios.post(\"http://localhost:3001/panels\", element).then(() => {\r\n        setPanels([\r\n          ...panels,\r\n          {\r\n            data: element,\r\n            headers: { \"Content-Type\": \"multipart/form-data\" },\r\n          },\r\n        ]);\r\n        updateDisplay();\r\n      });\r\n    else\r\n      axios.put(\"http://localhost:3001/panels\", element).then((res) => {\r\n        setPanels(\r\n          panels.map((item) => {\r\n            return item.id === element.id\r\n              ? {\r\n                  id: item.id,\r\n                  title: item.title,\r\n                  description: item.description,\r\n                  visualization_id: item.visualization_id,\r\n                  indicator_id: item.indicator_id,\r\n                }\r\n              : item;\r\n          })\r\n        );\r\n        updateDisplay();\r\n      });\r\n\r\n    setShowModal(false);\r\n    updateDisplay();\r\n  };\r\n\r\n  const deletePanel = (id) => {\r\n    window.confirm(\"Are you sure you want to delete this type of panel?\")\r\n      ? axios.delete(`http://localhost:3001/panels/${id}`).then((res) => {\r\n          setPanels(\r\n            panels.filter((item) => {\r\n              return item.id !== id;\r\n            })\r\n          );\r\n        })\r\n      : (id = id);\r\n    updateDisplay();\r\n  };\r\n\r\n  const getPanels = () => {\r\n    axios.get(\"http://localhost:3001/panels\").then((res) => {\r\n      setPanels(res.data);\r\n    });\r\n  };\r\n\r\n  const getVisualizations = () => {\r\n    axios.get(\"http://localhost:3001/visualizations\").then((res) => {\r\n      setVisualizations(res.data);\r\n    });\r\n  };\r\n  const getIndicators = () => {\r\n    axios.get(\"http://localhost:3001/indicators\").then((res) => {\r\n      setIndicators(res.data);\r\n    });\r\n  };\r\n\r\n  useEffect(() => {\r\n    getPanels();\r\n    getVisualizations();\r\n    getIndicators();\r\n  }, []);\r\n\r\n  const updateDisplay = () => {\r\n    getPanels();\r\n    getVisualizations();\r\n    getIndicators();\r\n  };\r\n\r\n  const decodeChart = (blob) => {\r\n    if (!blob) return;\r\n    if (typeof blob === \"string\") return blob;\r\n    const { data } = blob;\r\n    const img = new Buffer.from(data).toString(\"ascii\");\r\n\r\n    return img;\r\n  };\r\n\r\n  const fetchVizElement = (id) =>{\r\n      \r\n      if(typeof id === 'undefined') return{title:null,chart:null};\r\n      else{\r\n          let elt = visualizations.find(x  => x.id === id) \r\n          if(elt) return elt\r\n          else return{title:null,chart:null};\r\n      }\r\n  }\r\n\r\n  const fetchIndElement = (id) =>{\r\n      \r\n    if(typeof id === 'undefined') return;\r\n    else{\r\n        let elt = indicators.find(x  => x.id === id) \r\n        if(elt) return elt.title;\r\n    }\r\n}\r\n\r\n\r\n  const CreateNewPanel = () => {\r\n    const item = {\r\n      title: \"New\",\r\n      description: \"Description\",\r\n      visualization_id: null,\r\n      indicator_id: null,\r\n    };\r\n    setCurrentIndicator(indicators[0]);\r\n    setCurrentVisualization(visualizations[0]);\r\n\r\n    setCurrentPanel(item);\r\n    setCreationMode(true);\r\n    setShowModal(true);\r\n\r\n    return;\r\n  };\r\n  const EditPanel = (item) => {\r\n    \r\n    indicators.map((elt)=>{\r\n        if(elt.id == item.indicator_id) setCurrentIndicator(elt)\r\n    });\r\n\r\n\r\n    visualizations.map((elt)=>{\r\n        if(elt.id == item.visualization_id) setCurrentVisualization(elt)\r\n    });\r\n\r\n    setCurrentPanel(item);\r\n    \r\n    setCreationMode(false);\r\n    setShowModal(true);\r\n  };\r\n  return (\r\n    <PanelContext.Provider value={panelContext}>\r\n      <Actions\r\n        title=\"un titre\"\r\n        show={showModal}\r\n        mode=\"Creation\"\r\n        panels={panels}\r\n        setPanels={setPanels}\r\n        updateDisplay={updateDisplay}\r\n        onClose={handleModalClose}\r\n        onSave={handleModalSave}\r\n      />\r\n\r\n      <div>\r\n        <button className=\"btn btn-success\" onClick={CreateNewPanel}>\r\n          <AddBoxRounded /> &nbsp; New panel type\r\n        </button>\r\n      </div>\r\n      <table className=\"table table-bordered table-hover table-dark table-striped text-md-start\">\r\n        <thead>\r\n          <tr>\r\n            <th scope=\"col\">#</th>\r\n            <th scope=\"col\">Title</th>\r\n            <th scope=\"col\">Indicator</th>\r\n            <th scope=\"col\">Representation</th>\r\n            <th scope=\"col\">Description</th>\r\n            <th scope=\"col\">Actions</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {panels.map((item) => {\r\n            return (\r\n              <tr key={item.id}>\r\n                <th scope=\"row\">{item.id}</th>\r\n                <td>{item.title}</td>\r\n                <td>{fetchIndElement(item.indicator_id)}</td>\r\n                <td> <i>{fetchVizElement(item.visualization_id).title}</i>\r\n                  <div className=\"chart_box\">                  \r\n                    <img alt=\"Chart\" src={decodeChart(fetchVizElement(item.visualization_id).chart)} />\r\n                  </div>\r\n                </td>\r\n                <td>{item.description}</td>\r\n\r\n                <td>\r\n                  <button\r\n                    className=\"btn btn-sm btn-outline-primary\"\r\n                    onClick={() => EditPanel(item)}\r\n                  >\r\n                    <EditRounded />\r\n                  </button>\r\n                  <button\r\n                    className=\"btn btn-sm btn-outline-danger\"\r\n                    onClick={() => deletePanel(item.id)}\r\n                  >\r\n                    <HighlightOffRounded />\r\n                  </button>\r\n                </td>\r\n              </tr>\r\n            );\r\n          })}\r\n        </tbody>\r\n      </table>\r\n    </PanelContext.Provider>\r\n  );\r\n}\r\n\r\nexport default Panels;\r\n"]},"metadata":{},"sourceType":"module"}