{"ast":null,"code":"import _toConsumableArray from\"C:/Users/Madjid Sadallah/Documents/GitHub/CoGenDash/lad-creator/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"C:/Users/Madjid Sadallah/Documents/GitHub/CoGenDash/lad-creator/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import\"./library-view.css\";import React,{useState,useEffect}from\"react\";import Actions from\"./frames_lib/frame_actions\";import axios from\"axios\";import{AddBoxRounded,EditRounded,HighlightOffRounded,Loupe,RemoveCircle}from\"@material-ui/icons\";import FrameItem from\"./frames_lib/frame_items\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export var FrameContext=/*#__PURE__*/React.createContext();function Frames(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),frames=_useState2[0],setFrames=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),panels=_useState4[0],setPanels=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),cpanels=_useState6[0],setCPanels=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),showModal=_useState8[0],setShowModal=_useState8[1];var _useState9=useState(false),_useState10=_slicedToArray(_useState9,2),showItemModal=_useState10[0],setShowItemModal=_useState10[1];var _useState11=useState(),_useState12=_slicedToArray(_useState11,2),currentFrame=_useState12[0],setCurrentFrame=_useState12[1];var _useState13=useState(),_useState14=_slicedToArray(_useState13,2),currentPanel=_useState14[0],setCurrentPanel=_useState14[1];var _useState15=useState(),_useState16=_slicedToArray(_useState15,2),fList=_useState16[0],setfList=_useState16[1];var _useState17=useState(false),_useState18=_slicedToArray(_useState17,2),compositeMode=_useState18[0],setCompositeMode=_useState18[1];var frameContext=[currentFrame,setCurrentFrame,currentPanel,setCurrentPanel,fList,setfList,panels,cpanels];var _useState19=useState(true),_useState20=_slicedToArray(_useState19,2),creationMode=_useState20[0],setCreationMode=_useState20[1];var handleModalClose=function handleModalClose(){setShowModal(false);};var handleItemModalClose=function handleItemModalClose(){setShowItemModal(false);};var handleItemModalSave=function handleItemModalSave(){var element=currentFrame;var flist={isComposite:compositeMode,frame_id:currentFrame.id,panel_id:currentPanel.id};axios.post(\"http://localhost:3001/flist\",flist).then(function(){updateDisplay();});setShowItemModal(false);updateDisplay();};var handleModalSave=function handleModalSave(){var element=currentFrame;//return;\nif(creationMode)axios.post(\"http://localhost:3001/frames\",element).then(function(){setFrames([].concat(_toConsumableArray(frames),[{data:element,headers:{\"Content-Type\":\"multipart/form-data\"}}]));updateDisplay();});else axios.put(\"http://localhost:3001/frames\",element).then(function(res){setFrames(frames.map(function(item){return item.id===element.id?{id:item.id,title:item.title,description:item.description,class:\"\"}:item;}));updateDisplay();});setShowModal(false);updateDisplay();};var deleteFrame=function deleteFrame(id){window.confirm(\"Are you sure you want to delete this type of frame?\")?axios.delete(\"http://localhost:3001/frames/\".concat(id)).then(function(res){setFrames(frames.filter(function(item){return item.id!==id;}));}):id=id;updateDisplay();};var getFrames=function getFrames(){axios.get(\"http://localhost:3001/frames\").then(function(res){setFrames(res.data);});};var getFrameItems=function getFrameItems(item){if(!fList)return[];if(!item)return[];var elts=fList.filter(function(i){return i.frame_id===item.id;});return elts;};var getPanByID=function getPanByID(id,isComposite){var elt={title:\" \",description:\" \"};if(isComposite){if(cpanels)elt=cpanels.find(function(x){return x.id===id;});}else{if(panels)elt=panels.find(function(x){return x.id===id;});}if(!elt)elt={title:\" \",description:\" \"};return elt;};var dropCPanItem=function dropCPanItem(id){var i=0;window.confirm(\"Are you sure you want to delete this panel?\")?axios.delete(\"http://localhost:3001/flist/\".concat(id)).then(function(res){setfList(fList.filter(function(item){return item.id!==id;}));}):i=1;};var getPanels=function getPanels(){axios.get(\"http://localhost:3001/panels\").then(function(res){setPanels(res.data);});};var getCPanels=function getCPanels(){axios.get(\"http://localhost:3001/cpanels\").then(function(res){setCPanels(res.data);});};var getfList=function getfList(){axios.get(\"http://localhost:3001/flist\").then(function(res){setfList(res.data);});};useEffect(function(){getFrames();getPanels();getCPanels();getfList();},[]);var updateDisplay=function updateDisplay(){getFrames();getPanels();getCPanels();getfList();};var fetchPanelElement=function fetchPanelElement(id){if(typeof id===\"undefined\")return{title:null,chart:null};else{var elt=panels.find(function(x){return x.id===id;});if(elt)return elt;else return{title:null,description:null};}};var AddSimplePanel=function AddSimplePanel(item){setCompositeMode(false);var elt=fList.find(function(x){return x.frame_id===item.id;});setCurrentFrame(item);setCurrentPanel(panels[0]);setShowItemModal(true);};var AddCompositePanel=function AddCompositePanel(item){setCompositeMode(true);var elt=fList.find(function(x){return x.frame_id===item.id;});setCurrentFrame(item);setCurrentPanel(cpanels[0]);setShowItemModal(true);};var CreateNewFrame=function CreateNewFrame(){var item={title:\"NewFrame\",description:\"Description\"};setCurrentFrame(item);setCreationMode(true);setShowModal(true);return;};var EditFrame=function EditFrame(item){setCurrentFrame(item);setCreationMode(false);setShowModal(true);return;};return/*#__PURE__*/_jsxs(FrameContext.Provider,{value:frameContext,children:[/*#__PURE__*/_jsx(Actions,{title:\"un titre\",show:showModal,mode:\"Creation\",frames:frames,setFrames:setFrames,updateDisplay:updateDisplay,onClose:handleModalClose,onSave:handleModalSave}),/*#__PURE__*/_jsx(FrameItem,{title:\"un titre\",show:showItemModal,mode:\"Creation\",frames:frames,isComposite:compositeMode,setFrames:setFrames,updateDisplay:updateDisplay,onClose:handleItemModalClose,onSave:handleItemModalSave}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"button\",{className:\"btn btn-success\",onClick:CreateNewFrame,children:[/*#__PURE__*/_jsx(AddBoxRounded,{}),\" \\xA0 New Frame Type\"]})}),/*#__PURE__*/_jsxs(\"table\",{className:\"table table-bordered table-hover table-dark table-striped text-md-start\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"#\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Title\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Class\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Description\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Panels\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Actions\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:frames.map(function(item){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{scope:\"row\",children:item.id}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"h6\",{children:item.title})}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"i\",{children:item.class})}),/*#__PURE__*/_jsx(\"td\",{children:item.description}),/*#__PURE__*/_jsxs(\"td\",{children:[/*#__PURE__*/_jsxs(\"span\",{className:\"btn-sm btn-outline-info\",role:\"button\",onClick:function onClick(){return AddSimplePanel(item);},children:[/*#__PURE__*/_jsx(Loupe,{}),\" Simple Panel\"]}),\"\\xA0\\xA0\\xA0\",/*#__PURE__*/_jsxs(\"span\",{className:\"btn-sm btn-outline-info\",role:\"button\",onClick:function onClick(){return AddCompositePanel(item);},children:[/*#__PURE__*/_jsx(Loupe,{}),\" Composite Panel\"]}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"br\",{}),/*#__PURE__*/_jsx(\"ol\",{className:\"list-group-flush\",children:getFrameItems(item).map(function(i){return/*#__PURE__*/_jsxs(\"li\",{className:\"list-group-item d-flex justify-content-between align-items-center\",children:[/*#__PURE__*/_jsx(\"h6\",{children:getPanByID(i.panel_id,i.isComposite).title}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"i\",{children:i.isComposite?'Composite':'Simple'}),/*#__PURE__*/_jsx(\"span\",{role:\"button\",className:\"text-danger btn-sm\",onClick:function onClick(){return dropCPanItem(i.id);},children:/*#__PURE__*/_jsx(RemoveCircle,{})}),\" \"]})]});})}),/*#__PURE__*/_jsx(\"i\",{children:fetchPanelElement(item.id).title})]}),/*#__PURE__*/_jsxs(\"td\",{children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-sm btn-outline-primary\",onClick:function onClick(){return EditFrame(item);},children:/*#__PURE__*/_jsx(EditRounded,{})}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-sm btn-outline-danger\",onClick:function onClick(){return deleteFrame(item.id);},children:/*#__PURE__*/_jsx(HighlightOffRounded,{})})]})]},item.id);})})]})]});}export default Frames;","map":{"version":3,"sources":["C:/Users/Madjid Sadallah/Documents/GitHub/CoGenDash/lad-creator/src/components/library/frames.js"],"names":["React","useState","useEffect","Actions","axios","AddBoxRounded","EditRounded","HighlightOffRounded","Loupe","RemoveCircle","FrameItem","FrameContext","createContext","Frames","frames","setFrames","panels","setPanels","cpanels","setCPanels","showModal","setShowModal","showItemModal","setShowItemModal","currentFrame","setCurrentFrame","currentPanel","setCurrentPanel","fList","setfList","compositeMode","setCompositeMode","frameContext","creationMode","setCreationMode","handleModalClose","handleItemModalClose","handleItemModalSave","element","flist","isComposite","frame_id","id","panel_id","post","then","updateDisplay","handleModalSave","data","headers","put","res","map","item","title","description","class","deleteFrame","window","confirm","delete","filter","getFrames","get","getFrameItems","elts","i","getPanByID","elt","find","x","dropCPanItem","getPanels","getCPanels","getfList","fetchPanelElement","chart","AddSimplePanel","AddCompositePanel","CreateNewFrame","EditFrame"],"mappings":"4SAAA,MAAO,oBAAP,CACA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,CAA0BC,SAA1B,KAA2C,OAA3C,CACA,MAAOC,CAAAA,OAAP,KAAoB,4BAApB,CACA,MAAOC,CAAAA,KAAP,KAAkB,OAAlB,CACA,OACEC,aADF,CAEEC,WAFF,CAGEC,mBAHF,CAIEC,KAJF,CAKEC,YALF,KAMO,oBANP,CAOA,MAAOC,CAAAA,SAAP,KAAsB,0BAAtB,C,wFAEA,MAAO,IAAMC,CAAAA,YAAY,cAAGX,KAAK,CAACY,aAAN,EAArB,CAEP,QAASC,CAAAA,MAAT,EAAkB,CAChB,cAA4BZ,QAAQ,CAAC,EAAD,CAApC,wCAAOa,MAAP,eAAeC,SAAf,eACA,eAA4Bd,QAAQ,CAAC,EAAD,CAApC,yCAAOe,MAAP,eAAeC,SAAf,eACA,eAA8BhB,QAAQ,CAAC,EAAD,CAAtC,yCAAOiB,OAAP,eAAgBC,UAAhB,eAEA,eAAkClB,QAAQ,CAAC,KAAD,CAA1C,yCAAOmB,SAAP,eAAkBC,YAAlB,eACA,eAA0CpB,QAAQ,CAAC,KAAD,CAAlD,0CAAOqB,aAAP,gBAAsBC,gBAAtB,gBAEA,gBAAwCtB,QAAQ,EAAhD,2CAAOuB,YAAP,gBAAqBC,eAArB,gBACA,gBAAwCxB,QAAQ,EAAhD,2CAAOyB,YAAP,gBAAqBC,eAArB,gBACA,gBAA0B1B,QAAQ,EAAlC,2CAAO2B,KAAP,gBAAcC,QAAd,gBAEA,gBAA0C5B,QAAQ,CAAC,KAAD,CAAlD,2CAAO6B,aAAP,gBAAsBC,gBAAtB,gBAEA,GAAMC,CAAAA,YAAY,CAAG,CACnBR,YADmB,CAEnBC,eAFmB,CAGnBC,YAHmB,CAInBC,eAJmB,CAKnBC,KALmB,CAMnBC,QANmB,CAOnBb,MAPmB,CAQnBE,OARmB,CAArB,CAWA,gBAAwCjB,QAAQ,CAAC,IAAD,CAAhD,2CAAOgC,YAAP,gBAAqBC,eAArB,gBAEA,GAAMC,CAAAA,gBAAgB,CAAG,QAAnBA,CAAAA,gBAAmB,EAAM,CAC7Bd,YAAY,CAAC,KAAD,CAAZ,CACD,CAFD,CAGA,GAAMe,CAAAA,oBAAoB,CAAG,QAAvBA,CAAAA,oBAAuB,EAAM,CACjCb,gBAAgB,CAAC,KAAD,CAAhB,CACD,CAFD,CAIA,GAAMc,CAAAA,mBAAmB,CAAG,QAAtBA,CAAAA,mBAAsB,EAAM,CAChC,GAAIC,CAAAA,OAAO,CAAGd,YAAd,CACA,GAAIe,CAAAA,KAAK,CAAG,CACVC,WAAW,CAAEV,aADH,CAEVW,QAAQ,CAAEjB,YAAY,CAACkB,EAFb,CAGVC,QAAQ,CAAEjB,YAAY,CAACgB,EAHb,CAAZ,CAKAtC,KAAK,CAACwC,IAAN,CAAW,6BAAX,CAA0CL,KAA1C,EAAiDM,IAAjD,CAAsD,UAAM,CAC1DC,aAAa,GACd,CAFD,EAIAvB,gBAAgB,CAAC,KAAD,CAAhB,CACAuB,aAAa,GACd,CAbD,CAeA,GAAMC,CAAAA,eAAe,CAAG,QAAlBA,CAAAA,eAAkB,EAAM,CAC5B,GAAIT,CAAAA,OAAO,CAAGd,YAAd,CACA;AACA,GAAIS,YAAJ,CACE7B,KAAK,CAACwC,IAAN,CAAW,8BAAX,CAA2CN,OAA3C,EAAoDO,IAApD,CAAyD,UAAM,CAC7D9B,SAAS,8BACJD,MADI,GAEP,CACEkC,IAAI,CAAEV,OADR,CAEEW,OAAO,CAAE,CAAE,eAAgB,qBAAlB,CAFX,CAFO,GAAT,CAQAH,aAAa,GACd,CAVD,EADF,IAaE1C,CAAAA,KAAK,CAAC8C,GAAN,CAAU,8BAAV,CAA0CZ,OAA1C,EAAmDO,IAAnD,CAAwD,SAACM,GAAD,CAAS,CAC/DpC,SAAS,CACPD,MAAM,CAACsC,GAAP,CAAW,SAACC,IAAD,CAAU,CACnB,MAAOA,CAAAA,IAAI,CAACX,EAAL,GAAYJ,OAAO,CAACI,EAApB,CACH,CACEA,EAAE,CAAEW,IAAI,CAACX,EADX,CAEEY,KAAK,CAAED,IAAI,CAACC,KAFd,CAGEC,WAAW,CAAEF,IAAI,CAACE,WAHpB,CAIEC,KAAK,CAAE,EAJT,CADG,CAOHH,IAPJ,CAQD,CATD,CADO,CAAT,CAYAP,aAAa,GACd,CAdD,EAgBFzB,YAAY,CAAC,KAAD,CAAZ,CACAyB,aAAa,GACd,CAlCD,CAoCA,GAAMW,CAAAA,WAAW,CAAG,QAAdA,CAAAA,WAAc,CAACf,EAAD,CAAQ,CAC1BgB,MAAM,CAACC,OAAP,CAAe,qDAAf,EACIvD,KAAK,CAACwD,MAAN,wCAA6ClB,EAA7C,GAAmDG,IAAnD,CAAwD,SAACM,GAAD,CAAS,CAC/DpC,SAAS,CACPD,MAAM,CAAC+C,MAAP,CAAc,SAACR,IAAD,CAAU,CACtB,MAAOA,CAAAA,IAAI,CAACX,EAAL,GAAYA,EAAnB,CACD,CAFD,CADO,CAAT,CAKD,CAND,CADJ,CAQKA,EAAE,CAAGA,EARV,CASAI,aAAa,GACd,CAXD,CAaA,GAAMgB,CAAAA,SAAS,CAAG,QAAZA,CAAAA,SAAY,EAAM,CACtB1D,KAAK,CAAC2D,GAAN,CAAU,8BAAV,EAA0ClB,IAA1C,CAA+C,SAACM,GAAD,CAAS,CACtDpC,SAAS,CAACoC,GAAG,CAACH,IAAL,CAAT,CACD,CAFD,EAGD,CAJD,CAKA,GAAMgB,CAAAA,aAAa,CAAG,QAAhBA,CAAAA,aAAgB,CAACX,IAAD,CAAU,CAC9B,GAAI,CAACzB,KAAL,CAAY,MAAO,EAAP,CACZ,GAAI,CAACyB,IAAL,CAAW,MAAO,EAAP,CACX,GAAIY,CAAAA,IAAI,CAAGrC,KAAK,CAACiC,MAAN,CAAa,SAACK,CAAD,QAAOA,CAAAA,CAAC,CAACzB,QAAF,GAAeY,IAAI,CAACX,EAA3B,EAAb,CAAX,CACA,MAAOuB,CAAAA,IAAP,CACD,CALD,CAOA,GAAME,CAAAA,UAAU,CAAG,QAAbA,CAAAA,UAAa,CAACzB,EAAD,CAAKF,WAAL,CAAqB,CAEtC,GAAI4B,CAAAA,GAAG,CAAG,CACRd,KAAK,CAAE,GADC,CAERC,WAAW,CAAE,GAFL,CAAV,CAIA,GAAIf,WAAJ,CAAiB,CACf,GAAItB,OAAJ,CAAakD,GAAG,CAAGlD,OAAO,CAACmD,IAAR,CAAa,SAACC,CAAD,QAAOA,CAAAA,CAAC,CAAC5B,EAAF,GAASA,EAAhB,EAAb,CAAN,CACd,CAFD,IAEO,CACL,GAAI1B,MAAJ,CAAYoD,GAAG,CAAGpD,MAAM,CAACqD,IAAP,CAAY,SAACC,CAAD,QAAOA,CAAAA,CAAC,CAAC5B,EAAF,GAASA,EAAhB,EAAZ,CAAN,CACb,CAED,GAAI,CAAC0B,GAAL,CACEA,GAAG,CAAG,CACJd,KAAK,CAAE,GADH,CAEJC,WAAW,CAAE,GAFT,CAAN,CAKF,MAAOa,CAAAA,GAAP,CACD,CAnBD,CAqBA,GAAMG,CAAAA,YAAY,CAAG,QAAfA,CAAAA,YAAe,CAAC7B,EAAD,CAAQ,CAC3B,GAAIwB,CAAAA,CAAC,CAAG,CAAR,CACAR,MAAM,CAACC,OAAP,CAAe,6CAAf,EACIvD,KAAK,CAACwD,MAAN,uCAA4ClB,EAA5C,GAAkDG,IAAlD,CAAuD,SAACM,GAAD,CAAS,CAC9DtB,QAAQ,CACND,KAAK,CAACiC,MAAN,CAAa,SAACR,IAAD,CAAU,CACrB,MAAOA,CAAAA,IAAI,CAACX,EAAL,GAAYA,EAAnB,CACD,CAFD,CADM,CAAR,CAKD,CAND,CADJ,CAQKwB,CAAC,CAAG,CART,CASD,CAXD,CAaA,GAAMM,CAAAA,SAAS,CAAG,QAAZA,CAAAA,SAAY,EAAM,CACtBpE,KAAK,CAAC2D,GAAN,CAAU,8BAAV,EAA0ClB,IAA1C,CAA+C,SAACM,GAAD,CAAS,CACtDlC,SAAS,CAACkC,GAAG,CAACH,IAAL,CAAT,CACD,CAFD,EAGD,CAJD,CAMA,GAAMyB,CAAAA,UAAU,CAAG,QAAbA,CAAAA,UAAa,EAAM,CACvBrE,KAAK,CAAC2D,GAAN,CAAU,+BAAV,EAA2ClB,IAA3C,CAAgD,SAACM,GAAD,CAAS,CACvDhC,UAAU,CAACgC,GAAG,CAACH,IAAL,CAAV,CACD,CAFD,EAGD,CAJD,CAMA,GAAM0B,CAAAA,QAAQ,CAAG,QAAXA,CAAAA,QAAW,EAAM,CACrBtE,KAAK,CAAC2D,GAAN,CAAU,6BAAV,EAAyClB,IAAzC,CAA8C,SAACM,GAAD,CAAS,CACrDtB,QAAQ,CAACsB,GAAG,CAACH,IAAL,CAAR,CACD,CAFD,EAGD,CAJD,CAMA9C,SAAS,CAAC,UAAM,CACd4D,SAAS,GACTU,SAAS,GACTC,UAAU,GACVC,QAAQ,GACT,CALQ,CAKN,EALM,CAAT,CAOA,GAAM5B,CAAAA,aAAa,CAAG,QAAhBA,CAAAA,aAAgB,EAAM,CAC1BgB,SAAS,GACTU,SAAS,GACTC,UAAU,GACVC,QAAQ,GACT,CALD,CAOA,GAAMC,CAAAA,iBAAiB,CAAG,QAApBA,CAAAA,iBAAoB,CAACjC,EAAD,CAAQ,CAChC,GAAI,MAAOA,CAAAA,EAAP,GAAc,WAAlB,CAA+B,MAAO,CAAEY,KAAK,CAAE,IAAT,CAAesB,KAAK,CAAE,IAAtB,CAAP,CAA/B,IACK,CACH,GAAIR,CAAAA,GAAG,CAAGpD,MAAM,CAACqD,IAAP,CAAY,SAACC,CAAD,QAAOA,CAAAA,CAAC,CAAC5B,EAAF,GAASA,EAAhB,EAAZ,CAAV,CACA,GAAI0B,GAAJ,CAAS,MAAOA,CAAAA,GAAP,CAAT,IACK,OAAO,CAAEd,KAAK,CAAE,IAAT,CAAeC,WAAW,CAAE,IAA5B,CAAP,CACN,CACF,CAPD,CASA,GAAMsB,CAAAA,cAAc,CAAG,QAAjBA,CAAAA,cAAiB,CAACxB,IAAD,CAAU,CAC/BtB,gBAAgB,CAAC,KAAD,CAAhB,CACA,GAAIqC,CAAAA,GAAG,CAAGxC,KAAK,CAACyC,IAAN,CAAW,SAACC,CAAD,QAAOA,CAAAA,CAAC,CAAC7B,QAAF,GAAeY,IAAI,CAACX,EAA3B,EAAX,CAAV,CAEAjB,eAAe,CAAC4B,IAAD,CAAf,CACA1B,eAAe,CAACX,MAAM,CAAC,CAAD,CAAP,CAAf,CACAO,gBAAgB,CAAC,IAAD,CAAhB,CACD,CAPD,CASA,GAAMuD,CAAAA,iBAAiB,CAAG,QAApBA,CAAAA,iBAAoB,CAACzB,IAAD,CAAU,CAClCtB,gBAAgB,CAAC,IAAD,CAAhB,CACA,GAAIqC,CAAAA,GAAG,CAAGxC,KAAK,CAACyC,IAAN,CAAW,SAACC,CAAD,QAAOA,CAAAA,CAAC,CAAC7B,QAAF,GAAeY,IAAI,CAACX,EAA3B,EAAX,CAAV,CAEAjB,eAAe,CAAC4B,IAAD,CAAf,CACA1B,eAAe,CAACT,OAAO,CAAC,CAAD,CAAR,CAAf,CACAK,gBAAgB,CAAC,IAAD,CAAhB,CACD,CAPD,CASA,GAAMwD,CAAAA,cAAc,CAAG,QAAjBA,CAAAA,cAAiB,EAAM,CAC3B,GAAM1B,CAAAA,IAAI,CAAG,CACXC,KAAK,CAAE,UADI,CAEXC,WAAW,CAAE,aAFF,CAAb,CAIA9B,eAAe,CAAC4B,IAAD,CAAf,CACAnB,eAAe,CAAC,IAAD,CAAf,CACAb,YAAY,CAAC,IAAD,CAAZ,CAEA,OACD,CAVD,CAYA,GAAM2D,CAAAA,SAAS,CAAG,QAAZA,CAAAA,SAAY,CAAC3B,IAAD,CAAU,CAE1B5B,eAAe,CAAC4B,IAAD,CAAf,CACAnB,eAAe,CAAC,KAAD,CAAf,CACAb,YAAY,CAAC,IAAD,CAAZ,CACA,OACD,CAND,CAOA,mBACE,MAAC,YAAD,CAAc,QAAd,EAAuB,KAAK,CAAEW,YAA9B,wBACE,KAAC,OAAD,EACE,KAAK,CAAC,UADR,CAEE,IAAI,CAAEZ,SAFR,CAGE,IAAI,CAAC,UAHP,CAIE,MAAM,CAAEN,MAJV,CAKE,SAAS,CAAEC,SALb,CAME,aAAa,CAAE+B,aANjB,CAOE,OAAO,CAAEX,gBAPX,CAQE,MAAM,CAAEY,eARV,EADF,cAWE,KAAC,SAAD,EACE,KAAK,CAAC,UADR,CAEE,IAAI,CAAEzB,aAFR,CAGE,IAAI,CAAC,UAHP,CAIE,MAAM,CAAER,MAJV,CAKE,WAAW,CAAEgB,aALf,CAME,SAAS,CAAEf,SANb,CAOE,aAAa,CAAE+B,aAPjB,CAQE,OAAO,CAAEV,oBARX,CASE,MAAM,CAAEC,mBATV,EAXF,cAuBE,kCACE,gBAAQ,SAAS,CAAC,iBAAlB,CAAoC,OAAO,CAAE0C,cAA7C,wBACE,KAAC,aAAD,IADF,0BADF,EAvBF,cA4BE,eAAO,SAAS,CAAC,yEAAjB,wBACE,oCACE,mCACE,WAAI,KAAK,CAAC,KAAV,eADF,cAEE,WAAI,KAAK,CAAC,KAAV,mBAFF,cAGE,WAAI,KAAK,CAAC,KAAV,mBAHF,cAIE,WAAI,KAAK,CAAC,KAAV,yBAJF,cAKE,WAAI,KAAK,CAAC,KAAV,oBALF,cAME,WAAI,KAAK,CAAC,KAAV,qBANF,GADF,EADF,cAWE,uBACGjE,MAAM,CAACsC,GAAP,CAAW,SAACC,IAAD,CAAU,CACpB,mBACE,mCACE,WAAI,KAAK,CAAC,KAAV,UAAiBA,IAAI,CAACX,EAAtB,EADF,cAEE,iCACE,oBAAKW,IAAI,CAACC,KAAV,EADF,EAFF,cAKE,iCACE,mBAAID,IAAI,CAACG,KAAT,EADF,EALF,cAQE,oBAAKH,IAAI,CAACE,WAAV,EARF,cASE,mCACE,cACE,SAAS,CAAC,yBADZ,CAEE,IAAI,CAAC,QAFP,CAGE,OAAO,CAAE,yBAAMsB,CAAAA,cAAc,CAACxB,IAAD,CAApB,EAHX,wBAKE,KAAC,KAAD,IALF,mBADF,6BASE,cACE,SAAS,CAAC,yBADZ,CAEE,IAAI,CAAC,QAFP,CAGE,OAAO,CAAE,yBAAMyB,CAAAA,iBAAiB,CAACzB,IAAD,CAAvB,EAHX,wBAKE,KAAC,KAAD,IALF,sBATF,cAgBE,aAhBF,cAiBE,aAjBF,cAkBE,WAAI,SAAS,CAAC,kBAAd,UACGW,aAAa,CAACX,IAAD,CAAb,CAAoBD,GAApB,CAAwB,SAACc,CAAD,CAAO,CAC9B,mBACE,YAAI,SAAS,CAAC,mEAAd,wBACE,oBAAKC,UAAU,CAACD,CAAC,CAACvB,QAAH,CAAauB,CAAC,CAAC1B,WAAf,CAAV,CAAsCc,KAA3C,EADF,cAEE,oCACA,mBAAIY,CAAC,CAAC1B,WAAF,CAAe,WAAf,CAA2B,QAA/B,EADA,cAEA,aACE,IAAI,CAAC,QADP,CAEE,SAAS,CAAC,oBAFZ,CAGE,OAAO,CAAE,yBAAM+B,CAAAA,YAAY,CAACL,CAAC,CAACxB,EAAH,CAAlB,EAHX,uBAKE,KAAC,YAAD,IALF,EAFA,CAQQ,GARR,GAFF,GADF,CAcD,CAfA,CADH,EAlBF,cAoCE,mBAAIiC,iBAAiB,CAACtB,IAAI,CAACX,EAAN,CAAjB,CAA2BY,KAA/B,EApCF,GATF,cAkDE,mCACE,eACE,SAAS,CAAC,gCADZ,CAEE,OAAO,CAAE,yBAAM0B,CAAAA,SAAS,CAAC3B,IAAD,CAAf,EAFX,uBAIE,KAAC,WAAD,IAJF,EADF,cAOE,eACE,SAAS,CAAC,+BADZ,CAEE,OAAO,CAAE,yBAAMI,CAAAA,WAAW,CAACJ,IAAI,CAACX,EAAN,CAAjB,EAFX,uBAIE,KAAC,mBAAD,IAJF,EAPF,GAlDF,GAASW,IAAI,CAACX,EAAd,CADF,CAmED,CApEA,CADH,EAXF,GA5BF,GADF,CAkHD,CAED,cAAe7B,CAAAA,MAAf","sourcesContent":["import \"./library-view.css\";\r\nimport React, { useState, useEffect } from \"react\";\r\nimport Actions from \"./frames_lib/frame_actions\";\r\nimport axios from \"axios\";\r\nimport {\r\n  AddBoxRounded,\r\n  EditRounded,\r\n  HighlightOffRounded,\r\n  Loupe,\r\n  RemoveCircle,\r\n} from \"@material-ui/icons\";\r\nimport FrameItem from \"./frames_lib/frame_items\";\r\n\r\nexport const FrameContext = React.createContext();\r\n\r\nfunction Frames() {\r\n  const [frames, setFrames] = useState([]);\r\n  const [panels, setPanels] = useState([]);\r\n  const [cpanels, setCPanels] = useState([]);\r\n\r\n  const [showModal, setShowModal] = useState(false);\r\n  const [showItemModal, setShowItemModal] = useState(false);\r\n\r\n  const [currentFrame, setCurrentFrame] = useState();\r\n  const [currentPanel, setCurrentPanel] = useState();\r\n  const [fList, setfList] = useState();\r\n\r\n  const [compositeMode, setCompositeMode] = useState(false);\r\n\r\n  const frameContext = [\r\n    currentFrame,\r\n    setCurrentFrame,\r\n    currentPanel,\r\n    setCurrentPanel,\r\n    fList,\r\n    setfList,\r\n    panels,\r\n    cpanels,\r\n  ];\r\n\r\n  const [creationMode, setCreationMode] = useState(true);\r\n\r\n  const handleModalClose = () => {\r\n    setShowModal(false);\r\n  };\r\n  const handleItemModalClose = () => {\r\n    setShowItemModal(false);\r\n  };\r\n\r\n  const handleItemModalSave = () => {\r\n    let element = currentFrame;\r\n    let flist = {\r\n      isComposite: compositeMode,\r\n      frame_id: currentFrame.id,\r\n      panel_id: currentPanel.id,\r\n    };\r\n    axios.post(\"http://localhost:3001/flist\", flist).then(() => {\r\n      updateDisplay();\r\n    });\r\n\r\n    setShowItemModal(false);\r\n    updateDisplay();\r\n  };\r\n\r\n  const handleModalSave = () => {\r\n    let element = currentFrame;\r\n    //return;\r\n    if (creationMode)\r\n      axios.post(\"http://localhost:3001/frames\", element).then(() => {\r\n        setFrames([\r\n          ...frames,\r\n          {\r\n            data: element,\r\n            headers: { \"Content-Type\": \"multipart/form-data\" },\r\n          },\r\n        ]);\r\n\r\n        updateDisplay();\r\n      });\r\n    else\r\n      axios.put(\"http://localhost:3001/frames\", element).then((res) => {\r\n        setFrames(\r\n          frames.map((item) => {\r\n            return item.id === element.id\r\n              ? {\r\n                  id: item.id,\r\n                  title: item.title,\r\n                  description: item.description,\r\n                  class: \"\",\r\n                }\r\n              : item;\r\n          })\r\n        );\r\n        updateDisplay();\r\n      });\r\n\r\n    setShowModal(false);\r\n    updateDisplay();\r\n  };\r\n\r\n  const deleteFrame = (id) => {\r\n    window.confirm(\"Are you sure you want to delete this type of frame?\")\r\n      ? axios.delete(`http://localhost:3001/frames/${id}`).then((res) => {\r\n          setFrames(\r\n            frames.filter((item) => {\r\n              return item.id !== id;\r\n            })\r\n          );\r\n        })\r\n      : (id = id);\r\n    updateDisplay();\r\n  };\r\n\r\n  const getFrames = () => {\r\n    axios.get(\"http://localhost:3001/frames\").then((res) => {\r\n      setFrames(res.data);\r\n    });\r\n  };\r\n  const getFrameItems = (item) => {\r\n    if (!fList) return [];\r\n    if (!item) return [];\r\n    let elts = fList.filter((i) => i.frame_id === item.id);\r\n    return elts;\r\n  };\r\n\r\n  const getPanByID = (id, isComposite) => {\r\n      \r\n    let elt = {\r\n      title: \" \",\r\n      description: \" \",\r\n    };\r\n    if (isComposite) {\r\n      if (cpanels) elt = cpanels.find((x) => x.id === id);\r\n    } else {\r\n      if (panels) elt = panels.find((x) => x.id === id);\r\n    }\r\n    \r\n    if (!elt)\r\n      elt = {\r\n        title: \" \",\r\n        description: \" \",\r\n      };\r\n\r\n    return elt;\r\n  };\r\n\r\n  const dropCPanItem = (id) => {\r\n    let i = 0;\r\n    window.confirm(\"Are you sure you want to delete this panel?\")\r\n      ? axios.delete(`http://localhost:3001/flist/${id}`).then((res) => {\r\n          setfList(\r\n            fList.filter((item) => {\r\n              return item.id !== id;\r\n            })\r\n          );\r\n        })\r\n      : (i = 1);\r\n  };\r\n\r\n  const getPanels = () => {\r\n    axios.get(\"http://localhost:3001/panels\").then((res) => {\r\n      setPanels(res.data);\r\n    });\r\n  };\r\n\r\n  const getCPanels = () => {\r\n    axios.get(\"http://localhost:3001/cpanels\").then((res) => {\r\n      setCPanels(res.data);\r\n    });\r\n  };\r\n\r\n  const getfList = () => {\r\n    axios.get(\"http://localhost:3001/flist\").then((res) => {\r\n      setfList(res.data);\r\n    });\r\n  };\r\n\r\n  useEffect(() => {\r\n    getFrames();\r\n    getPanels();\r\n    getCPanels();\r\n    getfList();\r\n  }, []);\r\n\r\n  const updateDisplay = () => {\r\n    getFrames();\r\n    getPanels();\r\n    getCPanels();\r\n    getfList();\r\n  };\r\n\r\n  const fetchPanelElement = (id) => {\r\n    if (typeof id === \"undefined\") return { title: null, chart: null };\r\n    else {\r\n      let elt = panels.find((x) => x.id === id);\r\n      if (elt) return elt;\r\n      else return { title: null, description: null };\r\n    }\r\n  };\r\n\r\n  const AddSimplePanel = (item) => {\r\n    setCompositeMode(false);\r\n    let elt = fList.find((x) => x.frame_id === item.id);\r\n\r\n    setCurrentFrame(item);\r\n    setCurrentPanel(panels[0]);\r\n    setShowItemModal(true);\r\n  };\r\n\r\n  const AddCompositePanel = (item) => {\r\n    setCompositeMode(true);\r\n    let elt = fList.find((x) => x.frame_id === item.id);\r\n\r\n    setCurrentFrame(item);\r\n    setCurrentPanel(cpanels[0]);\r\n    setShowItemModal(true);\r\n  };\r\n\r\n  const CreateNewFrame = () => {\r\n    const item = {\r\n      title: \"NewFrame\",\r\n      description: \"Description\",\r\n    };\r\n    setCurrentFrame(item);\r\n    setCreationMode(true);\r\n    setShowModal(true);\r\n\r\n    return;\r\n  };\r\n\r\n  const EditFrame = (item) => {\r\n    \r\n    setCurrentFrame(item);\r\n    setCreationMode(false);\r\n    setShowModal(true);\r\n    return;\r\n  };\r\n  return (\r\n    <FrameContext.Provider value={frameContext}>\r\n      <Actions\r\n        title=\"un titre\"\r\n        show={showModal}\r\n        mode=\"Creation\"\r\n        frames={frames}\r\n        setFrames={setFrames}\r\n        updateDisplay={updateDisplay}\r\n        onClose={handleModalClose}\r\n        onSave={handleModalSave}\r\n      />\r\n      <FrameItem\r\n        title=\"un titre\"\r\n        show={showItemModal}\r\n        mode=\"Creation\"\r\n        frames={frames}\r\n        isComposite={compositeMode}\r\n        setFrames={setFrames}\r\n        updateDisplay={updateDisplay}\r\n        onClose={handleItemModalClose}\r\n        onSave={handleItemModalSave}\r\n      />\r\n\r\n      <div>\r\n        <button className=\"btn btn-success\" onClick={CreateNewFrame}>\r\n          <AddBoxRounded /> &nbsp; New Frame Type\r\n        </button>\r\n      </div>\r\n      <table className=\"table table-bordered table-hover table-dark table-striped text-md-start\">\r\n        <thead>\r\n          <tr>\r\n            <th scope=\"col\">#</th>\r\n            <th scope=\"col\">Title</th>\r\n            <th scope=\"col\">Class</th>\r\n            <th scope=\"col\">Description</th>\r\n            <th scope=\"col\">Panels</th>\r\n            <th scope=\"col\">Actions</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {frames.map((item) => {\r\n            return (\r\n              <tr key={item.id}>\r\n                <th scope=\"row\">{item.id}</th>\r\n                <td>\r\n                  <h6>{item.title}</h6>\r\n                </td>\r\n                <td>\r\n                  <i>{item.class}</i>\r\n                </td>\r\n                <td>{item.description}</td>\r\n                <td>\r\n                  <span\r\n                    className=\"btn-sm btn-outline-info\"\r\n                    role=\"button\"\r\n                    onClick={() => AddSimplePanel(item)}\r\n                  >\r\n                    <Loupe /> Simple Panel\r\n                  </span>\r\n                  &nbsp;&nbsp;&nbsp;\r\n                  <span\r\n                    className=\"btn-sm btn-outline-info\"\r\n                    role=\"button\"\r\n                    onClick={() => AddCompositePanel(item)}\r\n                  >\r\n                    <Loupe /> Composite Panel\r\n                  </span>\r\n                  <br />\r\n                  <br />\r\n                  <ol className=\"list-group-flush\">\r\n                    {getFrameItems(item).map((i) => {\r\n                      return (\r\n                        <li className=\"list-group-item d-flex justify-content-between align-items-center\">\r\n                          <h6>{getPanByID(i.panel_id, i.isComposite).title}</h6>\r\n                          <div>\r\n                          <i>{i.isComposite? 'Composite':'Simple'}</i>\r\n                          <span\r\n                            role=\"button\"\r\n                            className=\"text-danger btn-sm\"\r\n                            onClick={() => dropCPanItem(i.id)}\r\n                          >\r\n                            <RemoveCircle />\r\n                          </span>{\" \"}</div>\r\n                        </li>\r\n                      );\r\n                    })}\r\n                  </ol>\r\n                  <i>{fetchPanelElement(item.id).title}</i>\r\n                  {/*  <div className=\"chart_box\">                  \r\n                    <img alt=\"Chart\" src={decodeChart(fetchPanelElement(item.visualization_id).chart)} /> </div>*/}\r\n                </td>\r\n\r\n                <td>\r\n                  <button\r\n                    className=\"btn btn-sm btn-outline-primary\"\r\n                    onClick={() => EditFrame(item)}\r\n                  >\r\n                    <EditRounded />\r\n                  </button>\r\n                  <button\r\n                    className=\"btn btn-sm btn-outline-danger\"\r\n                    onClick={() => deleteFrame(item.id)}\r\n                  >\r\n                    <HighlightOffRounded />\r\n                  </button>\r\n                </td>\r\n              </tr>\r\n            );\r\n          })}\r\n        </tbody>\r\n      </table>\r\n    </FrameContext.Provider>\r\n  );\r\n}\r\n\r\nexport default Frames;\r\n"]},"metadata":{},"sourceType":"module"}