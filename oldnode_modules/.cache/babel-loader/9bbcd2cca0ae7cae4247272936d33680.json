{"ast":null,"code":"import _toConsumableArray from\"C:/Users/Madjid Sadallah/Documents/GitHub/CoGenDash/lad-creator/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"C:/Users/Madjid Sadallah/Documents/GitHub/CoGenDash/lad-creator/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import\"./library-view.css\";import React,{useState,useEffect}from\"react\";import Actions from\"./visualizations_lib/visualization_actions\";import axios from\"axios\";import{AddBoxRounded,EditRounded,HighlightOffRounded}from\"@material-ui/icons\";import DataTable from\"../specification/util/data-table\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export var VizContext=/*#__PURE__*/React.createContext();function Visualizations(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),visualizations=_useState2[0],setVisualizations=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),showModal=_useState4[0],setShowModal=_useState4[1];var handleModalClose=function handleModalClose(){setShowModal(false);};var handleModalSave=function handleModalSave(){if(creationMode)axios.post(\"http://localhost:3001/visualizations\",currentElement).then(function(){setVisualizations([].concat(_toConsumableArray(visualizations),[{data:currentElement,headers:{\"Content-Type\":\"multipart/form-data\"}}]));updateDisplay();});else axios.put(\"http://localhost:3001/visualizations\",currentElement).then(function(res){setVisualizations(visualizations.map(function(item){return item.id===currentElement.id?{id:item.id,title:item.title,description:item.description,class:item.class,chart:item.chart}:item;}));updateDisplay();});setShowModal(false);updateDisplay();};var deleteVisualization=function deleteVisualization(id){window.confirm(\"Are you sure you want to delete this type of visualization?\")?axios.delete(\"http://localhost:3001/visualizations/\".concat(id)).then(function(res){setVisualizations(visualizations.filter(function(item){return item.id!==id;}));}):id=id;updateDisplay();};var getVisualizations=function getVisualizations(){axios.get(\"http://localhost:3001/visualizations\").then(function(res){setVisualizations(res.data);});};useEffect(function(){getVisualizations();},[]);var updateDisplay=function updateDisplay(){getVisualizations();};var decodeChart=function decodeChart(blob){if(!blob)return;if(typeof blob===\"string\")return blob;var data=blob.data;var img=new Buffer.from(data).toString(\"ascii\");return img;};var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),currentElement=_useState6[0],setCurrentElement=_useState6[1];var _useState7=useState(true),_useState8=_slicedToArray(_useState7,2),creationMode=_useState8[0],setCreationMode=_useState8[1];var vizContext=[currentElement,setCurrentElement];var CreateNewVisualization=function CreateNewVisualization(){var item={title:\"New\",description:\"Description\",chart:null,class:\"Distribution\"};setCurrentElement(item);setCreationMode(true);setShowModal(true);return;};var EditVisualization=function EditVisualization(item){setCurrentElement(item);setCreationMode(false);setShowModal(true);};return/*#__PURE__*/_jsxs(VizContext.Provider,{value:vizContext,children:[/*#__PURE__*/_jsx(Actions,{title:\"un titre\",show:showModal,mode:\"Creation\",visualizations:visualizations,setVisualizations:setVisualizations,updateDisplay:updateDisplay,onClose:handleModalClose,onSave:handleModalSave}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"button\",{className:\"btn btn-success\",onClick:CreateNewVisualization,children:[/*#__PURE__*/_jsx(AddBoxRounded,{}),\" \\xA0 New visualization type\"]})}),/*#__PURE__*/_jsxs(\"table\",{className:\"table table-bordered table-hover table-dark table-striped text-md-start\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"#\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Title\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"CLass\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Representation\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Description\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Actions\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:visualizations.map(function(item){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{scope:\"row\",children:item.id}),/*#__PURE__*/_jsx(\"td\",{children:item.title}),/*#__PURE__*/_jsx(\"td\",{children:item.class}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"div\",{className:\"chart_box\",children:/*#__PURE__*/_jsx(\"img\",{alt:\"Chart\",src:decodeChart(item.chart)})})}),/*#__PURE__*/_jsx(\"td\",{children:item.description}),/*#__PURE__*/_jsxs(\"td\",{children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-sm btn-outline-primary\",onClick:function onClick(){return EditVisualization(item);},children:/*#__PURE__*/_jsx(EditRounded,{})}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-sm btn-outline-danger\",onClick:function onClick(){return deleteVisualization(item.id);},children:/*#__PURE__*/_jsx(HighlightOffRounded,{})})]})]},item.id);})})]})]});}export default Visualizations;","map":{"version":3,"sources":["C:/Users/Madjid Sadallah/Documents/GitHub/CoGenDash/lad-creator/src/components/library/visualizations.js"],"names":["React","useState","useEffect","Actions","axios","AddBoxRounded","EditRounded","HighlightOffRounded","DataTable","VizContext","createContext","Visualizations","visualizations","setVisualizations","showModal","setShowModal","handleModalClose","handleModalSave","creationMode","post","currentElement","then","data","headers","updateDisplay","put","res","map","item","id","title","description","class","chart","deleteVisualization","window","confirm","delete","filter","getVisualizations","get","decodeChart","blob","img","Buffer","from","toString","setCurrentElement","setCreationMode","vizContext","CreateNewVisualization","EditVisualization"],"mappings":"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","sourcesContent":["import \"./library-view.css\";\r\n\r\nimport React, { useState, useEffect } from \"react\";\r\nimport Actions from \"./visualizations_lib/visualization_actions\";\r\nimport axios from \"axios\";\r\nimport {\r\n  AddBoxRounded,\r\n  EditRounded,\r\n  HighlightOffRounded,\r\n} from \"@material-ui/icons\";\r\nimport DataTable from \"../specification/util/data-table\";\r\n\r\nexport const VizContext = React.createContext();\r\n\r\nfunction Visualizations() {\r\n  const [visualizations, setVisualizations] = useState([]);\r\n\r\n  const [showModal, setShowModal] = useState(false);\r\n\r\n  const handleModalClose = () => {\r\n    setShowModal(false);\r\n  };\r\n\r\n  const handleModalSave = () => {\r\n    if (creationMode)\r\n      axios\r\n        .post(\"http://localhost:3001/visualizations\", currentElement)\r\n        .then(() => {\r\n          setVisualizations([\r\n            ...visualizations,\r\n            {\r\n              data: currentElement,\r\n              headers: { \"Content-Type\": \"multipart/form-data\" },\r\n            },\r\n          ]);\r\n          updateDisplay();\r\n        });\r\n    else\r\n      axios\r\n        .put(\"http://localhost:3001/visualizations\", currentElement)\r\n        .then((res) => {\r\n          setVisualizations(\r\n            visualizations.map((item) => {\r\n              return item.id === currentElement.id\r\n                ? {\r\n                    id: item.id,\r\n                    title: item.title,\r\n                    description: item.description,\r\n                    class: item.class,\r\n                    chart: item.chart,\r\n                  }\r\n                : item;\r\n            })\r\n          );\r\n          updateDisplay();\r\n        });\r\n\r\n    setShowModal(false);\r\n    updateDisplay();\r\n  };\r\n\r\n  const deleteVisualization = (id) => {\r\n    window.confirm(\r\n      \"Are you sure you want to delete this type of visualization?\"\r\n    )\r\n      ? axios\r\n          .delete(`http://localhost:3001/visualizations/${id}`)\r\n          .then((res) => {\r\n            setVisualizations(\r\n              visualizations.filter((item) => {\r\n                return item.id !== id;\r\n              })\r\n            );\r\n          })\r\n      : (id = id);\r\n    updateDisplay();\r\n  };\r\n\r\n  const getVisualizations = () => {\r\n    axios.get(\"http://localhost:3001/visualizations\").then((res) => {\r\n      setVisualizations(res.data);\r\n    });\r\n  };\r\n\r\n  useEffect(() => {\r\n    getVisualizations();\r\n  }, []);\r\n\r\n  const updateDisplay = () => {\r\n    getVisualizations();\r\n  };\r\n\r\n  const decodeChart = (blob) => {\r\n    if (!blob) return;\r\n    if (typeof blob === \"string\") return blob;\r\n    const { data } = blob;\r\n    const img = new Buffer.from(data).toString(\"ascii\");\r\n\r\n    return img;\r\n  };\r\n\r\n  const [currentElement, setCurrentElement] = useState();\r\n  const [creationMode, setCreationMode] = useState(true);\r\n  const vizContext = [currentElement, setCurrentElement];\r\n\r\n  const CreateNewVisualization = () => {\r\n    const item = {\r\n      title: \"New\",\r\n      description: \"Description\",\r\n      chart: null,\r\n      class: \"Distribution\",\r\n    };\r\n\r\n    setCurrentElement(item);\r\n    setCreationMode(true);\r\n    setShowModal(true);\r\n\r\n    return;\r\n  };\r\n  const EditVisualization = (item) => {\r\n    setCurrentElement(item);\r\n    setCreationMode(false);\r\n    setShowModal(true);\r\n  };\r\n  return (\r\n    <VizContext.Provider value={vizContext}>\r\n      <Actions\r\n        title=\"un titre\"\r\n        show={showModal}\r\n        mode=\"Creation\"\r\n        visualizations={visualizations}\r\n        setVisualizations={setVisualizations}\r\n        updateDisplay={updateDisplay}\r\n        onClose={handleModalClose}\r\n        onSave={handleModalSave}\r\n      />\r\n\r\n      <div>\r\n        <button className=\"btn btn-success\" onClick={CreateNewVisualization}>\r\n          <AddBoxRounded /> &nbsp; New visualization type\r\n        </button>\r\n      </div>\r\n      <table className=\"table table-bordered table-hover table-dark table-striped text-md-start\">\r\n        <thead>\r\n          <tr>\r\n            <th scope=\"col\">#</th>\r\n            <th scope=\"col\">Title</th>\r\n            <th scope=\"col\">CLass</th>\r\n            <th scope=\"col\">Representation</th>\r\n            <th scope=\"col\">Description</th>\r\n            <th scope=\"col\">Actions</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {visualizations.map((item) => {\r\n            return (\r\n              <tr key={item.id}>\r\n                <th scope=\"row\">{item.id}</th>\r\n                <td>{item.title}</td>\r\n                <td>{item.class}</td>\r\n                <td>\r\n                  <div className=\"chart_box\">\r\n                    <img alt=\"Chart\" src={decodeChart(item.chart)} />\r\n                  </div>\r\n                </td>\r\n                <td>{item.description}</td>\r\n\r\n                <td>\r\n                  <button\r\n                    className=\"btn btn-sm btn-outline-primary\"\r\n                    onClick={() => EditVisualization(item)}\r\n                  >\r\n                    <EditRounded />\r\n                  </button>\r\n                  <button\r\n                    className=\"btn btn-sm btn-outline-danger\"\r\n                    onClick={() => deleteVisualization(item.id)}\r\n                  >\r\n                    <HighlightOffRounded />\r\n                  </button>\r\n                </td>\r\n              </tr>\r\n            );\r\n          })}\r\n        </tbody>\r\n      </table>\r\n    </VizContext.Provider>\r\n  );\r\n}\r\n\r\nexport default Visualizations;\r\n"]},"metadata":{},"sourceType":"module"}