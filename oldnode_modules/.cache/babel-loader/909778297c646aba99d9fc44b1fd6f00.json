{"ast":null,"code":"import _toConsumableArray from\"C:/Users/Madjid Sadallah/Documents/GitHub/CoGenDash/lad-creator/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _slicedToArray from\"C:/Users/Madjid Sadallah/Documents/GitHub/CoGenDash/lad-creator/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import\"./library-view.css\";import React,{useState,useEffect}from\"react\";import AddVisualization from\"./visualizations_lib/add_visualization\";import Edit from\"./visualizations_lib/edit_visualization\";import Delete from\"./visualizations_lib/delete_visualization\";import Actions from\"./visualizations_lib/visualization_actions\";import axios from\"axios\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export var VizContext=/*#__PURE__*/React.createContext();function Visualizations(){var _useState=useState([]),_useState2=_slicedToArray(_useState,2),visualizations=_useState2[0],setVisualizations=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),showModal=_useState4[0],setShowModal=_useState4[1];var handleModalClose=function handleModalClose(){setShowModal(false);};var handleModalSave=function handleModalSave(){if(creationMode)axios.post(\"http://localhost:3001/visualizations\",currentElement).then(function(){setVisualizations([].concat(_toConsumableArray(visualizations),[{data:currentElement,headers:{\"Content-Type\":\"multipart/form-data\"}}]));updateDisplay();});else axios.put(\"http://localhost:3001/visualizations\",currentElement).then(function(res){setVisualizations(visualizations.map(function(item){return item.id===currentElement.id?{id:item.id,title:item.title,description:item.description,class:item.class,chart:item.chart}:item;}));updateDisplay();});setShowModal(false);updateDisplay();};var deleteVisualization=function deleteVisualization(id){axios.delete(\"http://localhost:3001/visualizations/\".concat(id)).then(function(res){setVisualizations(visualizations.filter(function(item){return item.id!==id;}));});updateDisplay();};var getVisualizations=function getVisualizations(){axios.get(\"http://localhost:3001/visualizations\").then(function(res){setVisualizations(res.data);});};useEffect(function(){getVisualizations();},[]);var updateDisplay=function updateDisplay(){getVisualizations();};var decodeChart=function decodeChart(blob){if(!blob)return;if(typeof blob===\"string\")return blob;var data=blob.data;var img=new Buffer.from(data).toString(\"ascii\");return img;};var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),currentElement=_useState6[0],setCurrentElement=_useState6[1];var _useState7=useState(true),_useState8=_slicedToArray(_useState7,2),creationMode=_useState8[0],setCreationMode=_useState8[1];var vizContext=[currentElement,setCurrentElement];var CreateNewVisualization=function CreateNewVisualization(){var item={title:\"New\",description:\"Description\",chart:null};setCurrentElement(item);setCreationMode(true);setShowModal(true);return;};var EditVisualization=function EditVisualization(item){setCurrentElement(item);setCreationMode(false);setShowModal(true);};return/*#__PURE__*/_jsxs(VizContext.Provider,{value:vizContext,children:[/*#__PURE__*/_jsx(Actions,{title:\"un titre\",show:showModal,mode:\"Creation\",visualizations:visualizations,setVisualizations:setVisualizations,updateDisplay:updateDisplay,onClose:handleModalClose,onSave:handleModalSave}),/*#__PURE__*/_jsx(\"hr\",{}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-success\",onClick:CreateNewVisualization,children:\"NEW\"}),/*#__PURE__*/_jsx(\"h4\",{children:\"View, edit or delete defined types of visualizations\"}),/*#__PURE__*/_jsxs(\"table\",{className:\"table table-bordered table-hover table-dark table-striped text-md-start\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"#\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Title\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Type\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Representation\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Description\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Edit\"}),/*#__PURE__*/_jsx(\"th\",{scope:\"col\",children:\"Actions\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:visualizations.map(function(item){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{scope:\"row\",children:item.id}),/*#__PURE__*/_jsx(\"td\",{children:item.title}),/*#__PURE__*/_jsx(\"td\",{children:item.class}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"div\",{className:\"chart_box\",children:/*#__PURE__*/_jsx(\"img\",{alt:\"Chart\",src:decodeChart(item.chart)})})}),/*#__PURE__*/_jsx(\"td\",{children:item.description}),/*#__PURE__*/_jsx(\"td\",{}),/*#__PURE__*/_jsxs(\"td\",{children:[/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-outline-danger\",onClick:function onClick(){return EditVisualization(item);},children:\"Edit\"}),/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-outline-danger\",onClick:function onClick(){return deleteVisualization(item.id);},children:\"Delete\"})]})]});})})]})]});}export default Visualizations;","map":{"version":3,"sources":["C:/Users/Madjid Sadallah/Documents/GitHub/CoGenDash/lad-creator/src/components/library/visualizations.js"],"names":["React","useState","useEffect","AddVisualization","Edit","Delete","Actions","axios","VizContext","createContext","Visualizations","visualizations","setVisualizations","showModal","setShowModal","handleModalClose","handleModalSave","creationMode","post","currentElement","then","data","headers","updateDisplay","put","res","map","item","id","title","description","class","chart","deleteVisualization","delete","filter","getVisualizations","get","decodeChart","blob","img","Buffer","from","toString","setCurrentElement","setCreationMode","vizContext","CreateNewVisualization","EditVisualization"],"mappings":"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","sourcesContent":["import \"./library-view.css\";\r\n\r\nimport React, { useState, useEffect } from \"react\";\r\nimport AddVisualization from \"./visualizations_lib/add_visualization\";\r\nimport Edit from \"./visualizations_lib/edit_visualization\";\r\nimport Delete from \"./visualizations_lib/delete_visualization\";\r\nimport Actions from \"./visualizations_lib/visualization_actions\";\r\nimport axios from \"axios\";\r\n\r\nexport const VizContext = React.createContext();\r\n\r\nfunction Visualizations() {\r\n  const [visualizations, setVisualizations] = useState([]);\r\n\r\n  const [showModal, setShowModal] = useState(false);\r\n\r\n  const handleModalClose = () => {\r\n    setShowModal(false);\r\n  };\r\n\r\n  const handleModalSave = () => {\r\n    if (creationMode)\r\n      axios\r\n        .post(\"http://localhost:3001/visualizations\", currentElement)\r\n        .then(() => {\r\n          setVisualizations([\r\n            ...visualizations,\r\n            {\r\n              data: currentElement,\r\n              headers: { \"Content-Type\": \"multipart/form-data\" },\r\n            },\r\n          ]);\r\n          updateDisplay();\r\n        });\r\n    else\r\n      axios\r\n        .put(\"http://localhost:3001/visualizations\", currentElement)\r\n        .then((res) => {\r\n          setVisualizations(\r\n            visualizations.map((item) => {\r\n              return item.id === currentElement.id\r\n                ? {\r\n                    id: item.id,\r\n                    title: item.title,\r\n                    description: item.description,\r\n                    class: item.class,\r\n                    chart: item.chart,\r\n                  }\r\n                : item;\r\n            })\r\n          );\r\n          updateDisplay();\r\n        });\r\n\r\n    setShowModal(false);\r\n    updateDisplay();\r\n  };\r\n\r\n  const deleteVisualization = (id) => {\r\n    axios\r\n      .delete(`http://localhost:3001/visualizations/${id}`)\r\n      .then((res) => {\r\n        setVisualizations(\r\n          visualizations.filter((item) => {\r\n            return item.id !== id;\r\n          })\r\n        );\r\n      });\r\n      updateDisplay();\r\n  };\r\n\r\n  const getVisualizations = () => {\r\n    axios.get(\"http://localhost:3001/visualizations\").then((res) => {\r\n      setVisualizations(res.data);\r\n    });\r\n  };\r\n\r\n  useEffect(() => {\r\n    getVisualizations();\r\n  }, []);\r\n\r\n  const updateDisplay = () => {\r\n    getVisualizations();\r\n  };\r\n\r\n  const decodeChart = (blob) => {\r\n    if (!blob) return;\r\n    if (typeof blob === \"string\") return blob;\r\n    const { data } = blob;\r\n    const img = new Buffer.from(data).toString(\"ascii\");\r\n\r\n    return img;\r\n  };\r\n\r\n  const [currentElement, setCurrentElement] = useState();\r\n  const [creationMode, setCreationMode] = useState(true);\r\n  const vizContext = [currentElement, setCurrentElement];\r\n\r\n  const CreateNewVisualization = () => {\r\n    const item = {\r\n      title: \"New\",\r\n      description: \"Description\",\r\n      chart: null,\r\n    };\r\n\r\n    setCurrentElement(item);\r\n    setCreationMode(true);\r\n    setShowModal(true);\r\n\r\n    return;\r\n  };\r\n  const EditVisualization = (item) => {\r\n    setCurrentElement(item);\r\n    setCreationMode(false);\r\n    setShowModal(true);\r\n  };\r\n  return (\r\n    <VizContext.Provider value={vizContext}>\r\n      <Actions\r\n        title=\"un titre\"\r\n        show={showModal}\r\n        mode=\"Creation\"\r\n        visualizations={visualizations}\r\n        setVisualizations={setVisualizations}\r\n        updateDisplay={updateDisplay}\r\n        onClose={handleModalClose}\r\n        onSave={handleModalSave}\r\n      />\r\n      <hr />\r\n\r\n      <button className=\"btn btn-success\" onClick={CreateNewVisualization}>\r\n        NEW\r\n      </button>\r\n      <h4>View, edit or delete defined types of visualizations</h4>\r\n      <table className=\"table table-bordered table-hover table-dark table-striped text-md-start\">\r\n        <thead>\r\n          <tr>\r\n            <th scope=\"col\">#</th>\r\n            <th scope=\"col\">Title</th>\r\n            <th scope=\"col\">Type</th>\r\n            <th scope=\"col\">Representation</th>\r\n            <th scope=\"col\">Description</th>\r\n            <th scope=\"col\">Edit</th>\r\n            <th scope=\"col\">Actions</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {visualizations.map((item) => {\r\n            return (\r\n              <tr>\r\n                <th scope=\"row\">{item.id}</th>\r\n                <td>{item.title}</td>\r\n                <td>{item.class}</td>\r\n                <td>\r\n                  <div className=\"chart_box\">\r\n                    <img alt=\"Chart\" src={decodeChart(item.chart)} />\r\n                  </div>\r\n                </td>\r\n                <td>{item.description}</td>\r\n\r\n                <td></td>\r\n                <td>\r\n                  <button\r\n                    className=\"btn btn-outline-danger\"\r\n                    onClick={() => EditVisualization(item)}\r\n                  >\r\n                    Edit\r\n                  </button>\r\n                  <button\r\n                    className=\"btn btn-outline-danger\"\r\n                    onClick={() => deleteVisualization(item.id)}\r\n                  >\r\n                    Delete\r\n                  </button>\r\n                  \r\n                </td>\r\n              </tr>\r\n            );\r\n          })}\r\n        </tbody>\r\n      </table>\r\n    </VizContext.Provider>\r\n  );\r\n}\r\n\r\nexport default Visualizations;\r\n"]},"metadata":{},"sourceType":"module"}